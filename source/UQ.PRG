* UQ.PRG
* SAMPLE FRONT-END PROGRAM TO RUN USERQ.
* (USE FOR SETTING YOUR DEFAULT PARAMETERS).
*
* NOTE:
*	THIS IS TO PROVIDE AN EXAMPLE OF HOW YOU MIGHT WANT TO CREATE A
*	'FRONT-END' PROGRAM TO CALL USERQ.  A FRONT-END PRG LIKE THIS IS
*	USEFULL TO SET DEFAULT PARAMETERS (IE. USERID, DBF DIRECTORY, ETC).
*	
* PASS:
*	M.PARMS =	ANY PARAMETERS YOU WANT TO PASS TO USERQ.  NOTE: ANY
*				PARAMETERS PASSED TO THIS PRG WILL OVERRIDE ANY OF THE
*				'SAME PARAMETERS' SET HERE AS DEFAULTS.  THEREFORE,
*				THESE DEFAULT PARAMETERS CAN BE OVERRIDEN.

PARAMETERS M.PARMS

PRIVATE M.USERID, M.N1					&& LOCAL TEMP VARS

M.PARMS= IIF(PARAMETERS() = 0, "", M.PARMS)
										&& SET PARMS TO NULL IF NOT PASSED

***************************** MAIN LOGIC *****************************

PUSH MENU _MSYSMENU						&& SET MENU TO THE EDIT PAD ONLY
SET SYSMENU TO _MSM_EDIT				&& 	(OPTIONAL)

M.USERID= GETENV("LOGIN")				&& GET USER'S LOGIN FROM ENVIR VAR
										&&	(OPTIONAL)
M.USERQPARMS= "@qMISC @dC:\ @i" + M.USERID + "@tFoxPro Query"
										&& SET YOUR DEFAULT PARAMETERS.
M.N1= AT("@", M.PARMS)					&& GET POS OF FIRST SWITCH IF ANY
IF M.N1 > 0								&&	SWITCHES PASSED
	M.USERQPARMS= ;
		LEFT(M.PARMS, M.N1 - 1) + M.USERQPARMS + SUBS(M.PARMS, M.N1)
										&& PUT ANY FIL NAMES IN FRONT, AND
										&&	SWITCHES ON BACK (OF DEFAULTS)
ELSE
	M.USERQPARMS= M.PARMS + M.USERQPARMS
										&& ELSE NO SWITCHES PASSED, SO JUST
ENDIF									&&	PUT ANY FIL NAMES ON FRONT

RELEASE M.USERID, M.N1					&& DONT NEED THESE VARS ANYMORE

DO USERQ WITH M.USERQPARMS				&& RUN USERQ WITH PARAMETERS

POP MENU _MSYSMENU						&& RESTORE ORIG MENU

RETURN

******************************
